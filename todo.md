# TODO - Device Management System

## Functional Requirements

### 1. Device Management (UI + Backend + Database)

From the UI, the user should be able to:

#### 1.1 Create Device

##### Device types:
- Access Controller
- Face Recognition Reader
- ANPR

##### Each device stored in DB must include at minimum:
- `id` (UUID or auto-increment)
- `name` (string)
- `device_type` (enum/string) — one of: `access_controller`, `face_reader`, `anpr`
- `ip_address` (string)
- `status` (string) — `inactive` or `active`
- `created_at`, `updated_at` (timestamps)

> **Note:** You may include extra fields specific to device type.

#### 1.2 List Devices
- Show all devices from the database
- Display status as **Inactive** initially

#### 1.3 Activate Device

When the user clicks **Activate**, the backend should:
- Spin up a sub-process (e.g., Go routine / Python thread) for that device
- The presence of the sub-process indicates the device is active

##### Each active sub-process must:
- Simulate transaction creation at random intervals
- Transactions generated by device sub-processes must include:
  - `transaction_id` (UUID or unique)
  - `device_id` (foreign key)
  - `timestamp` (ISO datetime)
  - `username` (string) — generated randomly or from a small list
  - `message` or `event_type` (string) — e.g., `access_granted`, `face_match`, `plate_read`
  - any extra metadata (optional)
- Write each transaction directly into the database (`transactions` table)

---

### 2. Transaction Handling (Backend + Database)

#### 2.1 Backend Responsibilities

The Backend service is responsible for:
- Managing all device subprocesses
- Writing transactions directly into the database

#### 2.2 Database Access

Each subprocess should safely write to the shared database connection. Implement proper synchronization (mutex/locking or connection pooling) to avoid conflicts.

#### 2.3 Sample DB Schema for Transactions

```sql
CREATE TABLE transactions (
  transaction_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  device_id UUID REFERENCES devices(id),
  username TEXT,
  event_type TEXT,
  timestamp TIMESTAMP,
  payload JSONB,
  created_at TIMESTAMP DEFAULT now()
);
```

> **Note:** Candidate may adapt the schema as needed.

---

## Implementation Checklist

- [x] Design and implement database schema
  - [x] `devices` table
  - [x] `transactions` table
- [x] Backend API endpoints
  - [x] Create device
  - [x] List devices
  - [x] toggle device status
  - [x] list transaction
- [x] Device subprocess management
  - [x] Process spawning/thread management
  - [x] Random transaction generation logic
  - [x] Database connection pooling
- [x] UI Implementation
  - [x] Device creation form
  - [x] Device list view
  - [x] transaction list view
  - [x] toggle device status
  - [x] Status indicators
- [ ] Dockerize
  - [ ] Dockerize Backend
  - [ ] Dockerize Frontend
  - [ ] Docker compose to include backend, frontend and database with proper dependency and health checks